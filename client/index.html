<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>To Do App</title>

    <link rel="shortcut icon" href="img/favicon-chat.png" />
    <!-- Import Google Fonts -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Rajdhani:400,700" rel="stylesheet">
    <!-- Import materialize.css -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-beta/css/materialize.min.css">
    <!-- Import custom css -->
    <link rel="stylesheet" href="css/style.css">
    <!-- import animatae.css -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css" rel="stylesheet">

    <style>
        [v-cloak] {
            display: none;
        }
    </style>



</head>

<script type="text/x-template" id="modal-template">
    <transition name="modal">
        <div class="modal-mask">
            <div class="modal-wrapper">
                <div class="modal-container">

                    <div class="modal-header">
                        <slot name="header">
                            default header
                        </slot>
                    </div>

                    <div class="modal-body">
                        <slot name="body">
                            default body
                        </slot>
                    </div>

                    <div class="modal-footer">
                        <slot name="footer">
                            default footer
                            <button class="modal-default-button" @click="$emit('close')">
                                OK
                            </button>
                        </slot>
                    </div>
                </div>
            </div>
        </div>
    </transition>
</script>

<body>
    <div id="to-do-app">
        <!-- nav bar-->
        <div class="nav-bar">
            <button v-if='logged' type='button' v-on:click='logout()'>Logout</button>
            <div v-else>
                <button type='button' @click="showLogin=true">Login</button>
                <button type='button' @click="showRegister=true">Register</button>
                <label>{{user.name}}</label>
            </div>
        </div>

        <reg-component v-bind:register="register" v-if="showRegister"></reg-component>
        <login-component v-bind:login="login" v-if="showLogin"></login-component>
        <!-- container for grid -->
        <div class="row">
            <!-- project column -->
            <div class="col s3">
                <h4>Projects</h4>

                <div v-if="(user.role != 'Guest')">
                    <input v-on:keydown.enter="addProject()" type="text" v-model="newProjectName" placeholder='Add New Project'>
                </div>

                <div class="collection" v-for='project in projects'>
                    <a class="collection-item blue lighten-2 white-text" v-on:click='selectProject(project.id)'>{{project.name}}</a>
                </div>


            </div>
            <!-- To Dos column-->
            <div class="col s9" v-show='showProject'>
                <h3>{{currentProject.name}}</h3>
                <table>
                    <thead>
                        <td>Task</td>
                        <td>Completed</td>
                        <td> Delete</td>
                    </thead>
                    <tr v-for='todo in currentProject.toDoList'>
                        <td>
                            <label>
                                    {{todo.name}}
                            </label>
                        </td>
                        <td>    
                            <label>
                                <input type="checkbox" class="filled-in" v-model="todo.completed" v-on:click='completeToDo(todo._id)' v-if="(user.role != 'Guest')">
                                <span></span>
                            </label>
                        </td>
                        <td>
                            <a class="btn-floating red" v-on:click='deleteToDo(todo._id)' v-if="(user.role=='Admin')">
                                <i class="material-icons">delete_forever</i>
                            </a>
                        </td>
                    </tr>
                </table>
                <!-- buttons on bottom -->
                <div v-if="(user.role != 'Guest')">
                    <input type="text" v-model="newToDoDesc" placeholder='New Task'>
                    <a class="waves-effect waves-light btn green" v-on:click='addToDo()'>
                        <i class="material-icons right">add_circle_outline</i>Add</a>
                    <a class="waves-effect waves-light btn deep-orange accent-4" v-on:click='removeCompletedToDos()' v-if="(user.role=='Admin')">
                        <i class="material-icons right">cancel</i>Clear Completed Tasks</a>
                    <a class="right waves-effect waves-light btn red" v-on:click='deleteProject(currentProject._id)' v-if="(user.role=='Admin')">
                        <i class="material-icons right">warning</i>Delete Project</a>
                </div>

            </div>
        </div>
    </div>

    <script type="text/javascript" src="https://unpkg.com/vue@2.5.15/dist/vue.min.js"></script>
    <script type="text/javascript" src="https://unpkg.com/socket.io-client@2.1.0/dist/socket.io.js"></script>
    <script type="text/javascript" src="app.js"></script>
</body>

</html>